\section{Summary and Conclusions}
\label{sec:learner:summary}

An algorithm to learn extended activity models has been designed and developed in this chapter. The algorithm takes the results of the clustering process described in Chapter \ref{cha:clustering}, assuming that activity clusters have all the action sequences executed by a user to perform a concrete activity. Based on this assumption, it has been shown that learning extended activity models from activity clusters can be seen as purging spurious action sequences which appear due to sensor noise, clustering errors and/or user erratic behaviour (Section \ref{sec:learner:objectives}). It is very important to highlight the conservative approach adopted for the $AML$ algorithm. The highest priority is given to keep all real action sequences, even though this may imply not removing all spurious action sequences. The $AML$ algorithm has been designed around this conservative approach.

Before describing the $AML$ algorithm, all the available information has been analysed in order to identify what is relevant to learn extended activity models (Section \ref{sec:learner:relevant}). It has been shown that activity clusters and their associated occurrence frequencies are the only relevant available information.

With the objective clearly defined and the relevant input information identified, Section \ref{sec:learner:algorithm} describes how the $AML$ algorithm has been developed. It has two main steps: the filtering step (Section \ref{subsec:learner:filtering}), where action sequences are filtered based on the repeated actions and their order, and the similarity-based outlier detection step (Section \ref{subsec:learner:outlier}), where Jaccard coefficient is used to compute the similarity between action sequences to calculate a threshold which allows distinguishing between inlier and outlier similarities; the action sequences whose similarity is higher than the threshold are fused, taking their occurrence frequencies into consideration. The complete $AML$ algorithm and the output it generates have been described in Section \ref{subsec:learner:complete}. 

One of the most surprising facts about $AML$ might be that it does not use the occurrence frequencies of action sequences in the outlier detection step. It can be argued that if spurious action sequences are generated by sensor noise, clustering errors and/or user erratic behaviour, their occurrence frequency should be relatively low. This is generally true. However, using frequencies to detect outliers has a pernicious effect: it can identify as spurious those action sequences that even being valid, have been executed few times by the user. Imagine, for instance, that a user prepares coffee frequently. Only in some special occasions, this user likes preparing Irish coffee. If frequency is taken into account for outlier detection, the action sequences describing the preparation of an Irish coffee might be removed. This contradicts the conservative approach adopted for $AML$.

Indeed, the first metrics used for outlier detection combined Jaccard-based similarity and occurrence frequencies. It was observed that when executed action sequences for a concrete activity had big differences in their occurrence frequencies, those with lowest frequencies were fused incorrectly with other action sequences. After defining and testing many metrics combining similarity and frequency, the conclusion was that frequencies should not be used for detecting outliers. As described in Section \ref{subsec:learner:outlier}, $AML$ uses frequency only in the fusion function (equation \ref{eq-fusion}) implementing the heuristic that for two action sequences to be fused, once their similarity has been identified as being an outlier, the lower frequency action sequence is a spurious variation of the higher frequency one. 

The output of $AML$, stored in the learned action sequences file (Figure \ref{fig-aml-output}), is presented to the domain expert, who can analyse the extended activity models extracted by the solution and add them to the knowledge base with appropriate activity names, if convenient. As such, a human expert will always have the last decision about the learned activity models. That is one of the main reasons why the conservative approach for $AML$ has been adopted. If an activity model is removed incorrectly, a human expert will not have any way to recover that activity model. But if a spurious activity model is learned, the domain expert may remove it easily, looking at the action sequence and occurrence frequencies.